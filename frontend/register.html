<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js"
        integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.js"
        integrity="sha512-vHNHepeQWwAggJlhEk932jRS5sNdn/Nn4F+w4TpXW5dA+04qnd3e7YpfXo6auWhFG6z3FVhmScG4ovtF+qYeZw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="login.css">
</head>

<body>
    <div>
        <form id="registerForm" style="max-width: 450px; padding: 10px;" class="rounded card mx-auto mt-4">
            <h2 class="text-muted text-center">Sign Up</h2>
            <p class="text-danger hidden text-center" id="response"></p>
            <div class="d-flex gap-3" style="gap: 10px;">
                <div class="mb-4">
                    <label class="text-muted" for="name">first Name <span class="text-danger">*</span></label>
                    <input type="text" id="fname" name="name" class="form-control" placeholder="Enter your name"
                        required>
                </div>
                <div class="mb-4">
                    <label class="text-muted" for="name">Second Name <span class="text-danger">*</span></label>
                    <input type="text" id="lname" name="name" class="form-control" placeholder="Enter your name"
                        required>
                </div>
            </div>
            <div class="mb-4">
                <label class="text-muted" for="email">Email <span class="text-danger">*</span></label>
                <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email"
                    required>
            </div>
            <div class="d-flex gap-3" style="gap: 10px;">
                <div class="mb-4">
                    <label class="text-muted" for="password">Password <span class="text-danger">*</span></label>
                    <input type="password" id="pass1" name="password" class="form-control"
                        placeholder="Enter your password" required>
                </div>
                <div class="mb-4">
                    <label class="text-muted" for="password">Confirm Password <span class="text-danger">*</span></label>
                    <input type="password" id="pass2" name="password" class="form-control"
                        placeholder="confirm your password" required>
                </div>
            </div>
            <div class="mb-4">
                <label class="text-muted" for="password">Phone Number <span class="text-danger">*</span></label>
                <input type="tel" id="phone" name="phone" class="form-control" placeholder="Phone number" required>
            </div>
            <button class="btn btn-success" type="submit" onclick="register()">Sign Up</button>
            <center><small class="text-muted">Already Have Account <a href="login.html" class="text-primary">Sign
                        in</a></small></center>
    </div>
    </form>

    <script>
        const form = document.getElementById('registerForm');

        form.addEventListener('submit', function (event) {
            event.preventDefault();
            // Your form handling logic here
        });
        function register() {

            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

            let fname = document.getElementById("fname").value
            let lname = document.getElementById("lname").value
            let email = document.getElementById("email").value
            let pass1 = document.getElementById("pass1").value
            let pass2 = document.getElementById("pass2").value
            let phone = document.getElementById("phone").value
            if (fname == "") {
                document.getElementById("fname").focus()
                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter First Name"
            }
            else if (lname == "") {
                document.getElementById("lname").focus()

                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter Last Name"
            }
            else if (email == "" || !emailRegex.test(email)) {
                document.getElementById("email").focus()

                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter Valid Email"
            }
            else if (pass1 == "") {
                document.getElementById("pass1").focus()

                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter Password"
            }
            else if (pass2 == "") {
                document.getElementById("pass2").focus()

                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter Confirm Password"
            }
            else if (phone == "") {
                document.getElementById("phone").focus()
                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = " Please Enter phone"
            } else if (pass1 !== pass2) {
                document.getElementById("pass1").focus()
                document.getElementById("response").style.display
                    = "block"
                document.getElementById("response").innerHTML = "Passowrds dont macth"
            } else {
                let data = {
                    fname: fname,
                    lname: lname,
                    email: email,
                    pass1: pass1,
                    pass2: pass2,
                    phone: phone
                }
                axios.post("http://127.0.0.1:8081/api/register", data)
                    .then((res) => {
                        if (res.data) {
                            if (res.data.status == 200) {
                                window.location.href = "login.html"
                            } else {
                                if (res.data.Error) {
                                    document.getElementById("response").innerHTML = res.data.Error
                                } else {
                                    document.getElementById("response").innerHTML = "Error During Registeration"
                                }
                            }
                        } else {
                            document.getElementById("response").innerHTML = "Error while registering"
                        }

                    })
                    .catch((error) => {
                        if (error.response.data) {
                            document.getElementById("response").innerHTML = error.response.data.Error
                        } else {
                            document.getElementById("response").innerHTML = "Error During Registeration"
                        }

                    });
            }


        }
    </script>

</body>

</html>