<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js" integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.js" integrity="sha512-vHNHepeQWwAggJlhEk932jRS5sNdn/Nn4F+w4TpXW5dA+04qnd3e7YpfXo6auWhFG6z3FVhmScG4ovtF+qYeZw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="login.css">
</head>
<body>
  <div>
    <form id="registerForm" style="max-width: 450px; padding: 10px;" class="rounded card mx-auto mt-4">
      <h2 class="text-muted text-center">Sign In</h2>
      <p class="text-danger hidden text-center" id="response"></p>
      <div class="mb-4">
        <label class="text-muted" for="email">Email <span class="text-danger">*</span></label>
        <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email" required>
      </div>
      <div class="mb-4">
        <label class="text-muted" for="password">Password <span class="text-danger">*</span></label>
        <input type="password" id="pass1" name="password" class="form-control" placeholder="Enter your password" required>
      </div>

      <button class="btn btn-success" type="submit" onclick="login()">Sign in</button>
      <center><small class="text-muted">Create Account <a href="register.html" class="text-primary">Sign Up</a></small></center>
    </form>
  </div>

  <script>
    const form = document.getElementById('registerForm');

    form.addEventListener('submit', function (event) {
        event.preventDefault();
        // Your form handling logic here
    });
    function login() {

        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

        let email = document.getElementById("email").value
        let pass1 = document.getElementById("pass1").value

        if (email == "" || !emailRegex.test(email)) {
            document.getElementById("email").focus()

            document.getElementById("response").style.display
                = "block"
            document.getElementById("response").innerHTML = " Please Enter Valid Email"
        }
        else if (pass1 == "") {
            document.getElementById("pass1").focus()

            document.getElementById("response").style.display
                = "block"
            document.getElementById("response").innerHTML = " Please Enter Password"
        } else {
            let data = {
                email: email,
                pass1: pass1,
            }
            axios.post("http://127.0.0.1:8081/api/login", data)
.then((res) => {
   if(res.data.status == 200){
    console.log(res.data.userData)
    localStorage.setItem("userData",JSON.stringify(res.data.userData))
    window.location.href = "DASHBOARD/householder.html"
   }else{
    document.getElementById("response").innerHTML = "Error while log in"
   }
})
.catch((error) => {
  document.getElementById("response").innerHTML =error.response.data.error

});
        }


    }
</script>
  
 </body>
</html>
